using northWindDBChain
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 1: Quais são os produtos mais populares entre os clientes corporativos?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT product_id, COUNT(*) as total_sales
FROM order_details od
JOIN orders o ON od.order_id = o.id
JOIN customers c ON o.customer_id = c.id
WHERE c.company IS NOT NULL
AND o.status_id IN (2, 3)
AND od.status_id IN (1, 2, 3)
GROUP BY product_id
ORDER BY total_sales DESC;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 2: Quais são os produtos mais vendidos em termos de quantidade?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT product_id, SUM(quantity) AS total_quantity
FROM order_details
WHERE status_id IN (2, 3, 4) -- Allocated, Invoiced, Shipped
GROUP BY product_id
ORDER BY total_quantity DESC;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 3: Qual é o volume de vendas por cidade?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT o.ship_city, SUM(od.quantity * od.unit_price) AS total_sales
FROM orders o
JOIN order_details od ON o.id = od.order_id
JOIN orders_status os ON o.status_id = os.id
JOIN order_details_status ods ON od.status_id = ods.id
WHERE os.id IN (2, 3) AND ods.id IN (1, 2, 3)
GROUP BY o.ship_city;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 4: Quais são os clientes que mais compraram?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT c.id, c.company, COUNT(od.id) AS total_orders
FROM customers c
JOIN orders o ON c.id = o.customer_id
JOIN order_details od ON o.id = od.order_id
WHERE od.status_id IN (2, 3, 4) -- Allocated, Invoiced, Shipped
GROUP BY c.id, c.company
ORDER BY total_orders DESC;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 5: Quais são os produtos mais caros da loja?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT product_name, list_price 
FROM products 
ORDER BY list_price DESC 
LIMIT 5;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 6: Quais são os fornecedores mais frequentes nos pedidos?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT suppliers.company, COUNT(*) as total_orders
FROM suppliers
JOIN products ON suppliers.id = products.supplier_ids
JOIN order_details ON products.id = order_details.product_id
JOIN orders ON order_details.order_id = orders.id
WHERE orders.status_id IN (2, 3) 
AND order_details.status_id IN (1, 2, 3)
GROUP BY suppliers.company
ORDER BY total_orders DESC;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 7: Quais os melhores vendedores?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT e.first_name, e.last_name, COUNT(od.id) as total_sales
FROM employees e
JOIN orders o ON e.id = o.employee_id
JOIN order_details od ON o.id = od.order_id
JOIN orders_status os ON o.status_id = os.id
JOIN order_details_status ods ON od.status_id = ods.id
WHERE os.id IN (2, 3) AND ods.id IN (1, 2, 3)
GROUP BY e.first_name, e.last_name
ORDER BY total_sales DESC;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 8: Qual é o valor total de todas as vendas realizadas por ano?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT YEAR(order_date) AS year, SUM(unit_price * quantity) AS total_sales
FROM orders o
JOIN order_details od ON o.id = od.order_id
WHERE o.status_id IN (2, 3) 
AND od.status_id IN (2, 3, 4)
GROUP BY YEAR(order_date);
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 9: Qual é o valor total de vendas por categoria de produto?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT p.category, SUM(od.quantity * od.unit_price) AS total_sales
FROM products p
JOIN order_details od ON p.id = od.product_id
JOIN orders o ON od.order_id = o.id
JOIN orders_status os ON o.status_id = os.id
JOIN order_details_status ods ON od.status_id = ods.id
WHERE os.id IN (2, 3) AND ods.id IN (1, 2, 3)
GROUP BY p.category;
=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
Questáo 10: Qual o ticket médio por compra?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~SQL Gerado~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT AVG(od.quantity * od.unit_price) AS ticket_medio
FROM orders o
JOIN order_details od ON o.id = od.order_id
JOIN orders_status os ON o.status_id = os.id
JOIN order_details_status ods ON od.status_id = ods.id
WHERE os.id IN (2, 3) AND ods.id IN (1, 2, 3);
======================================FIM=======================================
